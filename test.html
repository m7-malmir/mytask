<!DOCTYPE html>
<html lang="fa">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Table Example</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body>
    <table id="tblLoanList" border="0" cellpadding="0" cellspacing="0" style="border-collapse:collapse">
        <tbody>
            <tr class="row-header">
                <td>انتخاب</td>
                <td>شناسه</td>
                <td>دلیل</td>
                <td>مبلغ</td>
                <td>تاریخ</td>
            </tr>
            <tr class="row-data">
                <td><input type="checkbox"></td>
                <td>1</td>
                <td>خرید مسکن</td>
                <td>100,000,000</td>
                <td>شنبه 4 اسفند 1403</td>
            </tr>
            <tr class="row-data">
                <td><input type="checkbox"></td>
                <td>18</td>
                <td>خرید لوازم ضروری</td>
                <td>0</td>
                <td>شنبه 4 اسفند 1403</td>
            </tr>
        </tbody>
    </table>

    <button id="getReasonButton">دریافت دلیل</button>

    <script>
        $(document).ready(function() {
            $('#getReasonButton').click(function() {
                // استخراج مقدار ستون "دلیل" از اولین ردیف
                var firstReason = $('#tblLoanList tbody tr.row-data:first td:eq(2)').text().trim();
                alert(firstReason); // نمایش دلیل در یک پنجره هشدار
            });
        });
    </script>
</body>
</html>









$("#btnConfirm").click(function(){
	var cancleApproveDescription='';
	if($("#txtDescConfirm").val()==''){
		cancleApproveDescription='انصراف مورد تایید می باشد';
	}else{
		cancleApproveDescription=$("#txtDescConfirm").val();
	}

				var params = {
			        'CancleStatus': 2,
			        'CancleRequestDescription': $("#txtCancleRequestDescription").val()
		    	};
				var selectedId = $('#tblLoanList tbody tr.row-data:first td:eq(2)').text().trim();
				pk= selectedId;	

				params = $.extend(params, { Where: "Id = '" + selectedId + "'" });
				
				FormManager.updateEntityLoanRequest(params,
		            
					    function(data)
					    {
							alert(JSON.stringify(params));
							var params = {
								'Context': 'تایید شد',
								'DocumentId': DocumentId,
								'CreatorActorId': currentActorId,
								'InboxId': InboxId
							};
							FormManager.InsertHamesh(params,
								function(data)
								{
							        Office.Inbox.setResponse(dialogArguments.WorkItem, 1, "", // تایید و ارسال به جهت رونوشت
							            function () {
											
							               closeWindow({ OK: true, Result: null });
							            }, function (err) { throw Error(err); }
							        );
							        alert(JSON.stringify('خطا در تشخیص پایکار جاری وام، لطفاً با پشتیبانی سیستم تماس حاصل نمایید'));
									
								}
							);
							
					        $.alert("درخواست شما با موفقیت ارسال شد.","","rtl",function(){
								hideLoading();
					        	closeWindow({OK:true, Result:null});
							});				
					    }
					    ,function(err)
					    {
					        alert('مشکلی در شروع فرآیند به وجود آمده. '+err);
					        hideLoading();
					    }
					);
					myHideLoading();
					if($.isFunction(callback))
					{
						callback();
					}
		            },
		            function(err) {
		                hideLoading();
		                alert(err);
		            }
		        );   

	
});